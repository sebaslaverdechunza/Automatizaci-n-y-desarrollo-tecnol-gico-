# üìä Validador y Exportador de Anexos

Aplicativo web sencillo para cargar archivos tabulares (`.csv` o `.xlsx`), validar m√≠nimamente la estructura y exportar un archivo Excel (‚Äúanexo‚Äù) con los datos limpios y un registro de errores.

Este ejercicio corresponde a la **Pregunta 1 ‚Äì Aplicativo de carga y exportaci√≥n**.

---

## üöÄ Instalaci√≥n y ejecuci√≥n

### 1. Clonar o copiar el repositorio
Ub√≠cate en la carpeta de trabajo y crea un entorno virtual:

```bash
python -m venv .venv
```

### 2. Activar el entorno virtual
Windows PowerShell:

```bash
.\.venv\Scripts\Activate.ps1
```
### 3. Instalar dependencias

```bash
pip install -r requirements.txt
```

### 4. Ejecutar el aplicativo

```bash
streamlit run app.py
```

La aplicaci√≥n se abrir√° en tu navegador en:
http://localhost:8501/
---

üñ•Ô∏è Interfaz del aplicativo

+ Subida de archivo (.csv o .xlsx).

+ Si es Excel: detecci√≥n autom√°tica de hojas y selector de cu√°l procesar.

+ Opcionales:

     + Columnas obligatorias: asegura que ciertas variables est√©n presentes.

     + Columnas porcentaje: permite forzar que se validen como %.

+ Bot√≥n Validar y generar anexo.

+ Panel de resultados:

     + Resumen de validaci√≥n.

     + Vista previa (primeras 20 filas).

     + Errores detectados.

     + Bot√≥n de descarga del anexo validado.
 

 ---
 
‚úÖ Pregunta 1 ‚Äì Aplicativo de carga y exportaci√≥n

## üñ•Ô∏è Dise√±o del aplicativo

### Interfaz
- **Input de archivo**: cargar un `.csv` o `.xlsx`.
- **Selector de hoja** (si es Excel; por defecto se usa `Base`).
- **Bot√≥n de validaci√≥n y exportaci√≥n**.
- **Vista previa**: primeras filas del archivo cargado.
- **Bot√≥n de descarga**: genera el anexo Excel con:
  - `Datos_Limpios` ‚Üí tabla con columnas num√©ricas convertidas.
  - `Errores_Validacion` ‚Üí lista de celdas que no pudieron convertirse.

### L√≥gica interna
1. **Carga del archivo** en memoria (con `pandas`).
2. **Detecci√≥n de columnas num√©ricas**: si ‚â•80% de los valores pueden convertirse a n√∫mero.
3. **Conversi√≥n y validaci√≥n**:  
   - Se normalizan separadores de miles/decimales.  
   - Se registran celdas no convertibles indicando fila y columna.  
4. **Exportaci√≥n**: se genera un Excel con dos hojas (datos limpios + errores).

---

## üîé Pseudoc√≥digo

INICIO
  archivo <- subir (.csv | .xlsx)
  si es Excel:
      hoja <- seleccionar (por defecto ‚ÄúBase‚Äù)

  df <- leer_archivo(archivo, hoja)

  clean <- copiar(df)
  errores <- []

  PARA cada columna en df:
    si es num√©rica:
      parsed <- normalizar_y_convertir(columna)
      registrar errores si no convertible
      si columna es porcentaje:
        registrar errores si valor <0 o >100
        guardar como fracci√≥n (Excel %)
      sino:
        guardar como num√©rico

  generar Excel con:
    - Hoja Datos_Limpios
    - Hoja Errores_Validacion
  ofrecer descarga
FIN

